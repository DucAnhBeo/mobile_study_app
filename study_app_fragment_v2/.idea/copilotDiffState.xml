<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/study_app/MainActivityNew.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/study_app/MainActivityNew.java" />
              <option name="originalContent" value="package com.example.study_app;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.util.Log;&#10;import android.widget.ImageButton;&#10;import android.widget.ImageView;&#10;import android.widget.LinearLayout;&#10;import android.widget.TextView;&#10;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.core.graphics.Insets;&#10;import androidx.core.view.ViewCompat;&#10;import androidx.core.view.WindowInsetsCompat;&#10;import androidx.fragment.app.Fragment;&#10;import androidx.fragment.app.FragmentManager;&#10;import androidx.fragment.app.FragmentTransaction;&#10;&#10;import com.example.study_app.fragments.ChatFragment;&#10;import com.example.study_app.fragments.ClassroomFragment;&#10;import com.example.study_app.fragments.DiscussionFragment;&#10;import com.example.study_app.fragments.HomeFragment;&#10;import com.example.study_app.fragments.QuizFragment;&#10;&#10;public class MainActivityNew extends AppCompatActivity {&#10;    private static final String TAG = &quot;MainActivityNew&quot;;&#10;&#10;    private int userId;&#10;    private String username;&#10;    private String fullName;&#10;    private TextView textViewUsername;&#10;&#10;    private LinearLayout buttonHome;&#10;    private LinearLayout buttonClassroom;&#10;    private LinearLayout buttonDiscussion;&#10;    private LinearLayout buttonQuiz;&#10;    private LinearLayout buttonChatbot;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_main_new);&#10;&#10;        // Xử lý system insets để tránh navigation bar bị che khuất&#10;        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main), (v, insets) -&gt; {&#10;            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());&#10;&#10;            // Áp dụng padding cho navigation bar&#10;            LinearLayout bottomNav = findViewById(R.id.bottomNavigationLayout);&#10;            if (bottomNav != null) {&#10;                bottomNav.setPadding(&#10;                        bottomNav.getPaddingLeft(),&#10;                        bottomNav.getPaddingTop(),&#10;                        bottomNav.getPaddingRight(),&#10;                        Math.max(20, systemBars.bottom) // Tối thiểu 20dp, hoặc theo system bar&#10;                );&#10;            }&#10;&#10;            return insets;&#10;        });&#10;&#10;        // Get user data from intent&#10;        userId = getIntent().getIntExtra(&quot;userId&quot;, -1);&#10;        username = getIntent().getStringExtra(&quot;username&quot;);&#10;        fullName = getIntent().getStringExtra(&quot;fullName&quot;);&#10;&#10;        Log.d(TAG, &quot;=== MAIN ACTIVITY RECEIVED ===&quot;);&#10;        Log.d(TAG, &quot;userId: &quot; + userId);&#10;        Log.d(TAG, &quot;username: &quot; + username);&#10;        Log.d(TAG, &quot;fullName: &quot; + fullName);&#10;        Log.d(TAG, &quot;==============================&quot;);&#10;&#10;        // Initialize views&#10;        initializeViews();&#10;        setupHeader();&#10;        setupNavigationBar();&#10;&#10;        // Load Home fragment by default&#10;        if (savedInstanceState == null) {&#10;            loadFragment(new HomeFragment());&#10;            setActiveNavigation(buttonHome);&#10;        }&#10;    }&#10;&#10;    private void initializeViews() {&#10;        // Header views&#10;        textViewUsername = findViewById(R.id.textViewUsername);&#10;        ImageButton buttonSettings = findViewById(R.id.buttonSettings);&#10;&#10;        // Navigation bar views&#10;        buttonHome = findViewById(R.id.buttonHome);&#10;        buttonClassroom = findViewById(R.id.buttonClassroom);&#10;        buttonDiscussion = findViewById(R.id.buttonDiscussion);&#10;        buttonQuiz = findViewById(R.id.buttonQuiz);&#10;        buttonChatbot = findViewById(R.id.buttonChatbot);&#10;&#10;        buttonSettings.setOnClickListener(v -&gt; showSettingsDialog());&#10;    }&#10;&#10;    private void setupHeader() {&#10;        if (fullName != null &amp;&amp; !fullName.isEmpty()) {&#10;            textViewUsername.setText(fullName);&#10;        } else if (username != null &amp;&amp; !username.isEmpty()) {&#10;            textViewUsername.setText(username);&#10;        } else {&#10;            textViewUsername.setText(&quot;admin&quot;);&#10;        }&#10;&#10;        TextView textViewRole = findViewById(R.id.textViewRole);&#10;        textViewRole.setText(&quot;Học sinh&quot;);&#10;    }&#10;&#10;    private void setupNavigationBar() {&#10;        buttonHome.setOnClickListener(v -&gt; {&#10;            loadFragment(new HomeFragment());&#10;            setActiveNavigation(buttonHome);&#10;        });&#10;&#10;        buttonClassroom.setOnClickListener(v -&gt; {&#10;            loadFragment(new ClassroomFragment());&#10;            setActiveNavigation(buttonClassroom);&#10;        });&#10;&#10;        buttonDiscussion.setOnClickListener(v -&gt; {&#10;            loadFragment(new DiscussionFragment());&#10;            setActiveNavigation(buttonDiscussion);&#10;        });&#10;&#10;        buttonQuiz.setOnClickListener(v -&gt; {&#10;            loadFragment(new QuizFragment());&#10;            setActiveNavigation(buttonQuiz);&#10;        });&#10;&#10;        buttonChatbot.setOnClickListener(v -&gt; {&#10;            loadFragment(new ChatFragment());&#10;            setActiveNavigation(buttonChatbot);&#10;        });&#10;    }&#10;&#10;    private void loadFragment(Fragment fragment) {&#10;        FragmentManager fragmentManager = getSupportFragmentManager();&#10;        FragmentTransaction fragmentTransaction = fragmentManager.beginTransaction();&#10;        fragmentTransaction.replace(R.id.fragmentContainer, fragment);&#10;        fragmentTransaction.commit();&#10;    }&#10;&#10;    private void setActiveNavigation(LinearLayout activeButton) {&#10;        // Reset all navigation buttons&#10;        resetNavigationButtons();&#10;&#10;        // Set active state for selected button với animation&#10;        activeButton.setSelected(true);&#10;        activeButton.setAlpha(1.0f);&#10;&#10;        // Animate active icon với hiệu ứng scale&#10;        animateIconCard(activeButton, true);&#10;    }&#10;&#10;    private void resetNavigationButtons() {&#10;        buttonHome.setSelected(false);&#10;        buttonClassroom.setSelected(false);&#10;        buttonDiscussion.setSelected(false);&#10;        buttonQuiz.setSelected(false);&#10;        buttonChatbot.setSelected(false);&#10;&#10;        buttonHome.setAlpha(0.7f);&#10;        buttonClassroom.setAlpha(0.7f);&#10;        buttonDiscussion.setAlpha(0.7f);&#10;        buttonQuiz.setAlpha(0.7f);&#10;        buttonChatbot.setAlpha(0.7f);&#10;&#10;        // Reset all icon cards&#10;        animateIconCard(buttonHome, false);&#10;        animateIconCard(buttonClassroom, false);&#10;        animateIconCard(buttonDiscussion, false);&#10;        animateIconCard(buttonQuiz, false);&#10;        animateIconCard(buttonChatbot, false);&#10;    }&#10;&#10;    private void animateIconCard(LinearLayout navButton, boolean isActive) {&#10;        // Tìm icon card, icon và label trong nav button&#10;        androidx.cardview.widget.CardView iconCard = null;&#10;        TextView label = null;&#10;        ImageView icon = null;&#10;&#10;        if (navButton == buttonHome) {&#10;            iconCard = findViewById(R.id.homeIconCard);&#10;            label = findViewById(R.id.homeLabel);&#10;            icon = findViewById(R.id.homeIcon);&#10;        } else if (navButton == buttonClassroom) {&#10;            iconCard = findViewById(R.id.classroomIconCard);&#10;            label = findViewById(R.id.classroomLabel);&#10;            icon = iconCard.findViewById(android.R.id.icon);&#10;        } else if (navButton == buttonDiscussion) {&#10;            iconCard = findViewById(R.id.discussionIconCard);&#10;            label = findViewById(R.id.discussionLabel);&#10;            icon = iconCard.findViewById(android.R.id.icon);&#10;        } else if (navButton == buttonQuiz) {&#10;            iconCard = findViewById(R.id.quizIconCard);&#10;            label = findViewById(R.id.quizLabel);&#10;            icon = iconCard.findViewById(android.R.id.icon);&#10;        } else if (navButton == buttonChatbot) {&#10;            iconCard = findViewById(R.id.chatbotIconCard);&#10;            label = findViewById(R.id.chatbotLabel);&#10;            icon = iconCard.findViewById(android.R.id.icon);&#10;        }&#10;&#10;        if (iconCard != null &amp;&amp; label != null) {&#10;            if (isActive) {&#10;                // Animation cho active state&#10;                iconCard.animate()&#10;                        .scaleX(1.1f)&#10;                        .scaleY(1.1f)&#10;                        .setDuration(200)&#10;                        .start();&#10;&#10;                iconCard.setCardBackgroundColor(getColor(R.color.nav_icon_background));&#10;&#10;                // Cập nhật màu icon cho Home&#10;                if (navButton == buttonHome &amp;&amp; icon != null) {&#10;                    icon.setColorFilter(getColor(R.color.text_white));&#10;                }&#10;&#10;                label.animate()&#10;                        .alpha(1.0f)&#10;                        .setDuration(200)&#10;                        .start();&#10;&#10;                // Thêm hiệu ứng bounce nhẹ&#10;                iconCard.animate()&#10;                        .scaleX(1.0f)&#10;                        .scaleY(1.0f)&#10;                        .setStartDelay(200)&#10;                        .setDuration(100)&#10;                        .start();&#10;&#10;            } else {&#10;                // Animation cho inactive state&#10;                iconCard.animate()&#10;                        .scaleX(1.0f)&#10;                        .scaleY(1.0f)&#10;                        .setDuration(150)&#10;                        .start();&#10;&#10;                iconCard.setCardBackgroundColor(getColor(android.R.color.transparent));&#10;&#10;                // Cập nhật màu icon cho Home về màu primary khi inactive&#10;                if (navButton == buttonHome &amp;&amp; icon != null) {&#10;                    icon.setColorFilter(getColor(R.color.primary_color));&#10;                }&#10;&#10;                label.animate()&#10;                        .alpha(0.6f)&#10;                        .setDuration(150)&#10;                        .start();&#10;            }&#10;        }&#10;    }&#10;&#10;    private void showSettingsDialog() {&#10;        new android.app.AlertDialog.Builder(this)&#10;                .setTitle(&quot;Tùy chọn&quot;)&#10;                .setItems(new String[]{&quot;Chỉnh sửa thông tin&quot;, &quot;Đăng xuất&quot;}, (dialog, which) -&gt; {&#10;                    if (which == 0) {&#10;                        // Edit Profile&#10;                        Intent intent = new Intent(this, EditProfileActivity.class);&#10;                        intent.putExtra(&quot;userId&quot;, userId);&#10;                        intent.putExtra(&quot;username&quot;, username);&#10;                        intent.putExtra(&quot;fullName&quot;, fullName);&#10;                        startActivity(intent);&#10;                    } else if (which == 1) {&#10;                        // Logout&#10;                        Intent intent = new Intent(this, LoginActivity.class);&#10;                        intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);&#10;                        startActivity(intent);&#10;                        finish();&#10;                    }&#10;                })&#10;                .show();&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.study_app;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.util.Log;&#10;import android.widget.ImageButton;&#10;import android.widget.ImageView;&#10;import android.widget.LinearLayout;&#10;import android.widget.TextView;&#10;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.core.graphics.Insets;&#10;import androidx.core.view.ViewCompat;&#10;import androidx.core.view.WindowInsetsCompat;&#10;import androidx.fragment.app.Fragment;&#10;import androidx.fragment.app.FragmentManager;&#10;import androidx.fragment.app.FragmentTransaction;&#10;&#10;import com.example.study_app.fragments.ChatFragment;&#10;import com.example.study_app.fragments.ClassroomFragment;&#10;import com.example.study_app.fragments.DiscussionFragment;&#10;import com.example.study_app.fragments.HomeFragment;&#10;import com.example.study_app.fragments.QuizFragment;&#10;&#10;public class MainActivityNew extends AppCompatActivity {&#10;    private static final String TAG = &quot;MainActivityNew&quot;;&#10;&#10;    private int userId;&#10;    private String username;&#10;    private String fullName;&#10;    private TextView textViewUsername;&#10;&#10;    private LinearLayout buttonHome;&#10;    private LinearLayout buttonClassroom;&#10;    private LinearLayout buttonDiscussion;&#10;    private LinearLayout buttonQuiz;&#10;    private LinearLayout buttonChatbot;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_main_new);&#10;&#10;        // Xử lý system insets để tránh navigation bar bị che khuất&#10;        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main), (v, insets) -&gt; {&#10;            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());&#10;&#10;            // Áp dụng padding cho navigation bar&#10;            LinearLayout bottomNav = findViewById(R.id.bottomNavigationLayout);&#10;            if (bottomNav != null) {&#10;                bottomNav.setPadding(&#10;                        bottomNav.getPaddingLeft(),&#10;                        bottomNav.getPaddingTop(),&#10;                        bottomNav.getPaddingRight(),&#10;                        Math.max(20, systemBars.bottom) // Tối thiểu 20dp, hoặc theo system bar&#10;                );&#10;            }&#10;&#10;            return insets;&#10;        });&#10;&#10;        // Get user data from intent&#10;        userId = getIntent().getIntExtra(&quot;userId&quot;, -1);&#10;        username = getIntent().getStringExtra(&quot;username&quot;);&#10;        fullName = getIntent().getStringExtra(&quot;fullName&quot;);&#10;&#10;        Log.d(TAG, &quot;=== MAIN ACTIVITY RECEIVED ===&quot;);&#10;        Log.d(TAG, &quot;userId: &quot; + userId);&#10;        Log.d(TAG, &quot;username: &quot; + username);&#10;        Log.d(TAG, &quot;fullName: &quot; + fullName);&#10;        Log.d(TAG, &quot;==============================&quot;);&#10;&#10;        // Initialize views&#10;        initializeViews();&#10;        setupHeader();&#10;        setupNavigationBar();&#10;&#10;        // Load Home fragment by default&#10;        if (savedInstanceState == null) {&#10;            loadFragment(new HomeFragment());&#10;            setActiveNavigation(buttonHome);&#10;        }&#10;    }&#10;&#10;    private void initializeViews() {&#10;        // Header views&#10;        textViewUsername = findViewById(R.id.textViewUsername);&#10;        ImageButton buttonSettings = findViewById(R.id.buttonSettings);&#10;&#10;        // Navigation bar views&#10;        buttonHome = findViewById(R.id.buttonHome);&#10;        buttonClassroom = findViewById(R.id.buttonClassroom);&#10;        buttonDiscussion = findViewById(R.id.buttonDiscussion);&#10;        buttonQuiz = findViewById(R.id.buttonQuiz);&#10;        buttonChatbot = findViewById(R.id.buttonChatbot);&#10;&#10;        buttonSettings.setOnClickListener(v -&gt; showSettingsDialog());&#10;    }&#10;&#10;    private void setupHeader() {&#10;        if (fullName != null &amp;&amp; !fullName.isEmpty()) {&#10;            textViewUsername.setText(fullName);&#10;        } else if (username != null &amp;&amp; !username.isEmpty()) {&#10;            textViewUsername.setText(username);&#10;        } else {&#10;            textViewUsername.setText(&quot;admin&quot;);&#10;        }&#10;&#10;        TextView textViewRole = findViewById(R.id.textViewRole);&#10;        textViewRole.setText(&quot;Học sinh&quot;);&#10;    }&#10;&#10;    private void setupNavigationBar() {&#10;        buttonHome.setOnClickListener(v -&gt; {&#10;            loadFragment(new HomeFragment());&#10;            setActiveNavigation(buttonHome);&#10;        });&#10;&#10;        buttonClassroom.setOnClickListener(v -&gt; {&#10;            loadFragment(new ClassroomFragment());&#10;            setActiveNavigation(buttonClassroom);&#10;        });&#10;&#10;        buttonDiscussion.setOnClickListener(v -&gt; {&#10;            loadFragment(new DiscussionFragment());&#10;            setActiveNavigation(buttonDiscussion);&#10;        });&#10;&#10;        buttonQuiz.setOnClickListener(v -&gt; {&#10;            loadFragment(new QuizFragment());&#10;            setActiveNavigation(buttonQuiz);&#10;        });&#10;&#10;        buttonChatbot.setOnClickListener(v -&gt; {&#10;            loadFragment(new ChatFragment());&#10;            setActiveNavigation(buttonChatbot);&#10;        });&#10;    }&#10;&#10;    private void loadFragment(Fragment fragment) {&#10;        FragmentManager fragmentManager = getSupportFragmentManager();&#10;        FragmentTransaction fragmentTransaction = fragmentManager.beginTransaction();&#10;        fragmentTransaction.replace(R.id.fragmentContainer, fragment);&#10;        fragmentTransaction.commit();&#10;    }&#10;&#10;    private void setActiveNavigation(LinearLayout activeButton) {&#10;        // Reset all navigation buttons&#10;        resetNavigationButtons();&#10;&#10;        // Set active state for selected button với animation&#10;        activeButton.setSelected(true);&#10;        activeButton.setAlpha(1.0f);&#10;&#10;        // Animate active icon với hiệu ứng scale&#10;        animateIconCard(activeButton, true);&#10;    }&#10;&#10;    private void resetNavigationButtons() {&#10;        buttonHome.setSelected(false);&#10;        buttonClassroom.setSelected(false);&#10;        buttonDiscussion.setSelected(false);&#10;        buttonQuiz.setSelected(false);&#10;        buttonChatbot.setSelected(false);&#10;&#10;        buttonHome.setAlpha(0.7f);&#10;        buttonClassroom.setAlpha(0.7f);&#10;        buttonDiscussion.setAlpha(0.7f);&#10;        buttonQuiz.setAlpha(0.7f);&#10;        buttonChatbot.setAlpha(0.7f);&#10;&#10;        // Reset all icon cards&#10;        animateIconCard(buttonHome, false);&#10;        animateIconCard(buttonClassroom, false);&#10;        animateIconCard(buttonDiscussion, false);&#10;        animateIconCard(buttonQuiz, false);&#10;        animateIconCard(buttonChatbot, false);&#10;    }&#10;&#10;    private void animateIconCard(LinearLayout navButton, boolean isActive) {&#10;        // Tìm icon card, icon và label trong nav button&#10;        androidx.cardview.widget.CardView iconCard = null;&#10;        TextView label = null;&#10;        ImageView icon = null;&#10;&#10;        if (navButton == buttonHome) {&#10;            iconCard = findViewById(R.id.homeIconCard);&#10;            label = findViewById(R.id.homeLabel);&#10;            icon = findViewById(R.id.homeIcon);&#10;        } else if (navButton == buttonClassroom) {&#10;            iconCard = findViewById(R.id.classroomIconCard);&#10;            label = findViewById(R.id.classroomLabel);&#10;            icon = iconCard.findViewById(android.R.id.icon);&#10;        } else if (navButton == buttonDiscussion) {&#10;            iconCard = findViewById(R.id.discussionIconCard);&#10;            label = findViewById(R.id.discussionLabel);&#10;            icon = iconCard.findViewById(android.R.id.icon);&#10;        } else if (navButton == buttonQuiz) {&#10;            iconCard = findViewById(R.id.quizIconCard);&#10;            label = findViewById(R.id.quizLabel);&#10;            icon = iconCard.findViewById(android.R.id.icon);&#10;        } else if (navButton == buttonChatbot) {&#10;            iconCard = findViewById(R.id.chatbotIconCard);&#10;            label = findViewById(R.id.chatbotLabel);&#10;            icon = iconCard.findViewById(android.R.id.icon);&#10;        }&#10;&#10;        if (iconCard != null &amp;&amp; label != null) {&#10;            if (isActive) {&#10;                // Animation cho active state&#10;                iconCard.animate()&#10;                        .scaleX(1.1f)&#10;                        .scaleY(1.1f)&#10;                        .setDuration(200)&#10;                        .start();&#10;&#10;                iconCard.setCardBackgroundColor(getColor(R.color.nav_icon_background));&#10;&#10;                // Cập nhật màu icon cho Home&#10;                if (navButton == buttonHome &amp;&amp; icon != null) {&#10;                    icon.setColorFilter(getColor(R.color.text_white));&#10;                }&#10;&#10;                label.animate()&#10;                        .alpha(1.0f)&#10;                        .setDuration(200)&#10;                        .start();&#10;&#10;                // Thêm hiệu ứng bounce nhẹ&#10;                iconCard.animate()&#10;                        .scaleX(1.0f)&#10;                        .scaleY(1.0f)&#10;                        .setStartDelay(200)&#10;                        .setDuration(100)&#10;                        .start();&#10;&#10;            } else {&#10;                // Animation cho inactive state&#10;                iconCard.animate()&#10;                        .scaleX(1.0f)&#10;                        .scaleY(1.0f)&#10;                        .setDuration(150)&#10;                        .start();&#10;&#10;                iconCard.setCardBackgroundColor(getColor(android.R.color.transparent));&#10;&#10;                // Cập nhật màu icon cho Home về màu primary khi inactive&#10;                if (navButton == buttonHome &amp;&amp; icon != null) {&#10;                    icon.setColorFilter(getColor(R.color.primary_color));&#10;                }&#10;&#10;                label.animate()&#10;                        .alpha(0.6f)&#10;                        .setDuration(150)&#10;                        .start();&#10;            }&#10;        }&#10;    }&#10;&#10;    private void showSettingsDialog() {&#10;        new android.app.AlertDialog.Builder(this)&#10;                .setTitle(&quot;Tùy chọn&quot;)&#10;                .setItems(new String[]{&quot;Chỉnh sửa thông tin&quot;, &quot;Đăng xuất&quot;}, (dialog, which) -&gt; {&#10;                    if (which == 0) {&#10;                        // Edit Profile&#10;                        Intent intent = new Intent(this, EditProfileActivity.class);&#10;                        intent.putExtra(&quot;userId&quot;, userId);&#10;                        intent.putExtra(&quot;username&quot;, username);&#10;                        intent.putExtra(&quot;fullName&quot;, fullName);&#10;                        startActivity(intent);&#10;                    } else if (which == 1) {&#10;                        // Logout&#10;                        Intent intent = new Intent(this, LoginActivity.class);&#10;                        intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);&#10;                        startActivity(intent);&#10;                        finish();&#10;                    }&#10;                })&#10;                .show();&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>